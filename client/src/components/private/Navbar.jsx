import React, { useState } from "react";
import { Link } from "react-router-dom";
import { useSelector } from "react-redux";
import CustomImage from "../shared/CustomImage";
import Menu from "../shared/Menu";
/**
 * Componente Navbar principale dell'app lato utente.
 *
 * FunzionalitÃ :
 * - Mostra il logo del ristorante con link alla home (`/private`).
 * - Mostra l'icona del carrello con un badge che indica la quantitÃ  totale degli articoli.
 *   Il badge appare solo se il carrello contiene almeno un articolo.
 * - Mostra il menu laterale cliccando sull'icona `Menu.png`.
 * 
 * Stato interno:
 * - `selectMenu`: booleano per aprire/chiudere il menu laterale.
 * 
 * Redux:
 * - Estrae dal `cartSlice` l'array `items` per calcolare la quantitÃ  totale (`totalQuantity`)
 *   sommando le `item.quantity`.
 */

const Navbar = () => {
  const [selectMenu, setSelectMenu] = useState(false);
  const items = useSelector((state) => state.cart.items);
  const totalQuantity = items.reduce((sum, item) => sum + item.quantity, 0);

  const toggleMenu = () => {
    setSelectMenu((p) => !p);
  };

  return (
    <nav className="flex justify-center w-full h-[66px] relative z-20">
      <div className="flex items-center justify-between min-w-[375px]  bg-primary px-5 relative">
        <div>
          <Link to="/private/categories">
            <svg className="w-[38px]" xmlns="http://www.w3.org/2000/svg" width="680" height="934" viewBox="0 0 680 934" fill="none">
              <g clipPath="url(#clip0_58_1085)">
                <path fillRule="evenodd" clipRule="evenodd" d="M461.681 475.761C473.184 464.093 481.116 441.547 480.493 423.9C479.248 390.973 479.414 357.381 475.51 324.662C472.727 301.493 467.993 284.219 461.681 284.219" fill="white" />
                <path fillRule="evenodd" clipRule="evenodd" d="M541.874 180.165V56.5948C536.641 76.4839 526.176 94.2554 511.973 108.414C491.25 129.134 462.677 141.964 431.198 142.006H431.074H431.032C399.553 142.006 370.898 129.134 350.133 108.373C329.41 87.6534 316.536 59.0446 316.536 27.6123V27.5292C316.536 24.0829 319.36 21.2594 322.807 21.2594C326.254 21.2594 329.078 24.0829 329.078 27.5292V27.6123C329.119 55.6398 340.54 81.1344 358.979 99.5702C377.418 118.006 402.917 129.466 430.991 129.466H431.032H431.157C459.189 129.466 484.688 118.006 503.127 99.5702C521.566 81.1344 533.028 55.6398 533.028 27.5708V27.5292V27.4462C533.028 17.9791 531.699 8.80273 529.249 0.0830688H244.317C242.988 9.01034 242.323 18.1452 242.323 27.4462V27.5292V27.5708C242.323 79.5565 263.545 126.726 297.723 160.898C331.902 195.071 379.079 216.248 430.991 216.289H431.074H431.115C472.478 216.206 510.727 202.836 541.874 180.165Z" fill="white" />
                <path fillRule="evenodd" clipRule="evenodd" d="M276.834 567.235H361.471L365.831 451.388C365.831 422.903 365.001 411.9 347.891 395.997C341.578 390.101 337.633 381.88 337.591 372.786V372.703L342.326 275.001C342.326 271.929 344.817 269.479 347.891 269.479C350.964 269.479 353.414 271.929 353.414 275.001L348.68 372.703V372.786C348.721 378.226 351.171 383.291 355.158 386.987C358.065 389.686 361.72 391.679 365.831 392.675V274.96C365.831 271.68 368.489 269.022 371.77 269.022C375.051 269.022 377.75 271.68 377.75 274.96V392.634C381.82 391.637 385.475 389.686 388.382 386.987C392.41 383.25 394.902 378.184 394.902 372.703V372.662L390.666 274.96C390.666 271.887 393.157 269.437 396.189 269.437C399.221 269.437 401.712 271.887 401.712 274.96L405.99 372.662V372.703C405.948 381.838 402.045 390.101 395.649 395.997C378.996 411.443 377.75 422.447 377.75 449.934L384.312 567.193H449.762V275.915C449.762 269.064 458.649 265.617 465.003 270.06C479.123 279.901 484.937 302.821 487.761 324.828C491.956 357.381 492.329 390.682 492.62 423.485C492.828 444.786 491.25 461.228 467.827 488.799C463.923 493.408 461.681 499.304 461.681 506.197C463.923 516.453 467.329 526.46 468.45 536.882L471.606 567.235H541.874V195.445C510.062 216.497 471.98 228.746 431.157 228.787H431.115H431.032C375.632 228.787 325.34 206.158 288.877 169.743C252.415 133.286 229.781 82.9613 229.781 27.5292V27.4877V27.4046C229.781 18.1452 230.404 9.0103 231.609 0.0415039H205.611C208.892 61.3283 220.23 118.629 257.232 178.089C325.257 287.209 277.332 446.197 276.834 567.235Z" fill="white" />
                <path fillRule="evenodd" clipRule="evenodd" d="M127.121 171.736C128.616 171.238 130.485 170.822 134.015 170.532C157.894 168.539 194.44 170.739 214.291 178.67C218.61 180.372 222.638 182.407 226.127 184.691C226.667 185.023 228.328 187.182 228.536 187.805C264.417 295.846 230.986 334.793 200.254 370.627C183.642 389.976 167.903 408.371 166.2 437.27C166.242 438.64 166.283 440.052 166.283 441.505C166.283 442.17 166.2 442.793 166.034 443.332V565.2C166.034 565.906 165.909 566.57 165.66 567.193H264.915C265.414 448.896 313.671 291.029 247.182 184.275C208.726 122.573 197.056 63.4874 193.776 0H127.121" fill="white" />
                <path fillRule="evenodd" clipRule="evenodd" d="M127.121 360.537C127.827 361.326 128.533 362.115 129.198 362.904C130.443 364.357 131.731 365.81 132.977 367.264C133.89 368.011 134.804 368.717 135.801 369.34C137.711 370.669 139.788 371.831 141.989 372.786C142.861 373.16 143.65 373.534 144.314 373.783V373.741C149.215 375.61 154.489 376.648 159.763 376.648H159.888C167.488 376.648 175.087 374.53 181.524 370.835L181.566 370.876C182.687 370.212 183.892 369.464 185.137 368.551C186.259 367.762 187.339 366.848 188.377 365.893H188.418L188.501 365.81L188.626 365.935C189.29 365.188 189.955 364.399 190.578 363.651C190.785 363.402 191.035 363.112 191.242 362.862C219.69 329.728 250.588 293.645 217.904 193.535C215.454 192.123 212.796 190.794 209.889 189.632C191.948 182.448 166.449 180.497 144.065 182.365C138.085 182.864 132.354 183.653 127.121 184.608" fill="white" />
                <path fillRule="evenodd" clipRule="evenodd" d="M127.121 567.235H154.447C154.24 566.612 154.115 565.947 154.115 565.242V441.505V436.813C154.115 436.564 154.157 436.315 154.157 436.066C152.412 411.9 140.701 395.125 127.121 378.807" fill="white" />
                <path fillRule="evenodd" clipRule="evenodd" d="M674.892 873.627V884.464H655.581V932.962H643.288V884.464H624.102V873.627M601.385 873.627V934H601.053L566.002 899.869V932.962H553.627V872.589H553.959L589.009 906.72V873.627H601.385ZM503.085 896.381L495.569 914.152H510.602L503.085 896.381ZM503.252 872.589L531.907 932.962H518.368L514.506 923.786H491.706L487.844 932.962H474.264L502.919 872.589H503.252ZM432.818 884.298H422.975V901.405H432.818C435.766 901.405 438.134 900.658 439.878 899.205C441.622 897.71 442.494 895.634 442.494 892.852C442.494 890.194 441.622 888.077 439.878 886.582C438.134 885.045 435.766 884.298 432.818 884.298ZM433.939 873.627C439.878 873.627 444.861 875.371 448.931 878.776C453.001 882.222 455.036 886.914 455.036 892.81C455.036 896.879 454.081 900.326 452.087 903.274C450.136 906.18 447.478 908.422 444.155 909.917L457.943 932.921H443.532L431.115 911.993H422.975V932.921H410.724V873.627H433.939ZM384.146 873.627V911.661C384.146 918.554 382.152 923.993 378.207 928.021C374.262 932.049 368.614 934.042 361.305 934.042C353.995 934.042 348.347 932.049 344.402 928.021C340.457 924.035 338.463 918.554 338.463 911.661V873.627H350.798V910.831C350.798 914.485 351.711 917.391 353.455 919.55C355.241 921.71 357.858 922.789 361.305 922.789C364.668 922.789 367.285 921.71 369.154 919.55C370.981 917.391 371.895 914.485 371.895 910.831V873.627H384.146ZM288.628 896.381L281.112 914.152H296.104L288.628 896.381ZM288.753 872.589L317.408 932.962H303.87L300.007 923.786H277.249L273.387 932.962H259.849L288.504 872.589H288.753ZM242.614 873.627V884.464H223.303V932.962H211.01V884.464H191.865V873.627H242.614ZM150.419 872.589C158.849 872.589 165.785 874.665 171.184 878.817L164.788 888.99C160.469 885.544 155.652 883.841 150.336 883.841C144.688 883.841 141.864 886 141.864 890.277C141.864 892.021 142.611 893.35 144.148 894.388C145.685 895.384 148.633 896.256 152.994 897.087C160.428 898.665 165.66 900.824 168.65 903.647C171.64 906.471 173.177 910.249 173.177 914.983C173.177 920.755 171.184 925.363 167.155 928.851C163.127 932.339 157.687 934.042 150.71 934.042C141.49 934.042 133.849 931.426 127.702 926.111L134.389 915.855C136.382 917.931 138.915 919.633 141.989 920.879C145.062 922.125 148.093 922.789 151.125 922.789C154.24 922.789 156.648 922.208 158.351 921.045C160.054 919.882 160.884 918.222 160.884 916.104C160.884 914.319 160.054 912.865 158.393 911.786C156.731 910.706 153.741 909.793 149.422 908.962C142.113 907.384 136.922 905.142 133.973 902.194C130.983 899.204 129.488 895.426 129.488 890.817C129.488 885.419 131.399 881.018 135.219 877.654C139.04 874.291 144.107 872.589 150.419 872.589ZM107.395 873.627V884.838H81.3973V897.71H103.906V908.132H81.3973V921.793H108.059V933.004H69.0632V873.627H107.395ZM22.1351 884.298H12.2927V901.405H22.1351C25.0837 901.405 27.4508 900.658 29.1951 899.205C30.9393 897.71 31.8114 895.634 31.8114 892.852C31.8114 890.194 30.9393 888.077 29.1951 886.582C27.4508 885.045 25.0837 884.298 22.1351 884.298ZM23.2564 873.627C29.1535 873.627 34.1786 875.371 38.2484 878.776C42.3183 882.222 44.3532 886.914 44.3532 892.81C44.3532 896.879 43.3565 900.326 41.4047 903.274C39.4528 906.18 36.7949 908.422 33.431 909.917L47.2188 932.921H32.8496L20.4324 911.993H12.2511V932.921H0V873.627H23.2564Z" fill="white" />
                <path fillRule="evenodd" clipRule="evenodd" d="M631.037 805.946H679.959V829.696H605.87V686.445H677.924V710.195H631.037V745.614H674.02V768.534H631.037M472.188 686.445H497.77V829.696H473.018V784.894C473.849 763.468 474.513 747.026 475.053 735.566L474.015 735.15C472.478 739.386 470.277 745.738 467.287 754.292C464.256 762.846 462.096 768.991 460.726 772.811L451.091 798.181H426.09L416.497 772.811C410.475 755.621 406.032 743.081 403.166 735.15L402.128 735.566C402.668 747.026 403.374 763.427 404.163 784.894V829.696H379.619V686.445H404.993L428.333 742.5C432.859 753.545 436.099 762.43 438.134 769.115H438.964C440.584 763.801 443.948 754.915 448.973 742.5L472.188 686.445ZM223.635 779.787H246.975L241.244 753.171C240.164 747.69 238.253 735.981 235.512 717.96H234.89C232.979 732.867 231.152 744.576 229.366 753.171L223.635 779.787ZM257.814 829.696L252.083 803.703H218.527L212.796 829.696H186.591L221.808 686.445H248.843L284.06 829.696H257.814ZM65.99 686.445H90.7415V829.696H65.7824L38.1239 767.455C30.0672 746.61 25.6236 734.901 24.8345 732.451L24.2116 733.074C26.2465 751.095 27.2848 769.572 27.2848 788.548V829.696H2.53333V686.445H27.4924L57.3935 753.752C58.7639 757.157 60.7573 762.306 63.4152 769.199C66.0731 776.091 67.9004 780.7 68.8555 783.025L69.4785 782.403C67.1528 764.133 65.99 746.652 65.99 730.002V686.445Z" fill="white" />
              </g>
              <defs>
                <clipPath id="clip0_58_1085">
                  <rect width="680" height="934" fill="white" />
                </clipPath>
              </defs>
            </svg>
          </Link>
        </div>
        <div className="flex items-center gap-4">
          <div>
            <Link to="/private/cart">
              {totalQuantity > 0 && (
                <span className="absolute -top-1 mr-14 mt-3.5 -right-1 bg-[#FFFFFF] text-[#3BC8E1] text-[10px] w-4 h-4 rounded-full font-bold flex items-center justify-center leading-none">
                  {totalQuantity}
                </span>
              )}
              <svg className="text-white opacity-100 cursor-pointer" xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                <g clipPath="url(#clip0_1153_1175)">
                  <path d="M25.8385 6.81996C25.6942 6.63506 25.4727 6.527 25.2382 6.527H6.25184C6.09229 5.88879 5.82244 4.80929 5.55574 3.743C5.00487 1.53922 3.03356 0 0.761833 0C0.341166 0 0.00012207 0.341044 0.00012207 0.761711C0.00012207 1.18238 0.341166 1.52342 0.761833 1.52342C2.33319 1.52342 3.69676 2.58804 4.07782 4.11253L6.82485 15.1011C7.03392 15.9373 7.52273 16.6422 8.17628 17.1277C6.86959 18.3697 7.16209 20.643 8.714 21.5263C7.33865 23.3252 8.67713 26.0209 10.9604 25.9997C13.0255 26.0276 14.4198 23.7339 13.4519 21.9203H17.4434C16.4758 23.7342 17.8696 26.0276 19.935 25.9997C23.6461 25.859 23.6454 20.5372 19.935 20.3969H10.1444C8.45095 20.3325 8.45222 17.9048 10.1444 17.841H20.5611C22.2241 17.841 23.6672 16.7143 24.0704 15.1011L25.9771 7.4734C26.034 7.24591 25.9829 7.0048 25.8385 6.81996ZM19.935 21.9204C20.6397 21.9204 21.213 22.4937 21.213 23.1984C21.1487 24.8915 18.721 24.891 18.657 23.1984C18.657 22.4937 19.2303 21.9204 19.935 21.9204ZM10.9603 21.9204C11.665 21.9204 12.2383 22.4937 12.2383 23.1984C12.1741 24.8915 9.74637 24.891 9.68234 23.1984C9.68234 22.4937 10.2557 21.9204 10.9603 21.9204ZM22.5925 14.7316C22.359 15.6654 21.5237 16.3176 20.5611 16.3176H10.3341C9.37151 16.3176 8.53621 15.6654 8.30278 14.7317L6.63265 8.05048H24.2626L22.5925 14.7316Z" fill="currentColor" />
                </g>
                <defs>
                  <clipPath id="clip0_1153_1175">
                    <rect width="26" height="26" fill="currentColor" />
                  </clipPath>
                </defs>
              </svg>
            </Link>
          </div>
          <div className="cursor-pointer flex justify-end items-center">
            <div onClick={toggleMenu}>
              {selectMenu ? (
                <CustomImage
                  src="/images/Delete.png"
                  alt="menu"
                  className="text-white"
                />
              ) : (
                <svg className="text-white opacity-100 cursor-pointer" xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">
                  <g>
                    <path d="M24.9844 11.9844H1.01562C0.454695 11.9844 0 12.4391 0 13C0 13.5609 0.454695 14.0156 1.01562 14.0156H24.9844C25.5453 14.0156 26 13.5609 26 13C26 12.4391 25.5453 11.9844 24.9844 11.9844Z" fill="currentColor" />
                    <path d="M24.9844 3.85938H1.01562C0.454695 3.85938 0 4.31407 0 4.875C0 5.43593 0.454695 5.89062 1.01562 5.89062H24.9844C25.5453 5.89062 26 5.43593 26 4.875C26 4.31407 25.5453 3.85938 24.9844 3.85938Z" fill="currentColor" />
                    <path d="M24.9844 20.1094H1.01562C0.454695 20.1094 0 20.5641 0 21.125C0 21.6859 0.454695 22.1406 1.01562 22.1406H24.9844C25.5453 22.1406 26 21.6859 26 21.125C26 20.5641 25.5453 20.1094 24.9844 20.1094Z" fill="currentColor" />
                  </g>
                </svg>
              )}

            </div>
            {selectMenu && <Menu toggleMenu={toggleMenu}/>}
          </div>
        </div>
      </div>
    </nav>
  );
};

export default Navbar;
